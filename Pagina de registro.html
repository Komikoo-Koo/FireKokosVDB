<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Komikoos Vitals Data Base</title>

  <!-- Cargar Firebase (compat) -->
  <script src="https://www.gstatic.com/firebasejs/10.11.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.11.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.11.1/firebase-database-compat.js"></script>

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Poppins', sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      background: linear-gradient(to bottom, #FF0000 0%, #FF0000 70%, #800000 85%, #000000 100%);
    }

    .overlay {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0, 0, 0, 0.6);
    }

    .container {
      position: relative; display: flex; width: 80%; max-width: 1100px;
      justify-content: space-between; align-items: center; color: white; z-index: 2;
    }

    .welcome-text {
      flex: 1; padding: 20px; max-width: 1000px; position: relative; left: -180px;
    }

    .welcome-text h1 { font-size: 90px; font-weight: bold; }

    .welcome-text p {
      font-size: 16px;
      line-height: 1.6;
      max-width: 600px;
    }
    
    .form-container {
      background: rgba(255, 255, 255, 0.1);
      padding: 30px; border-radius: 10px;
      display: flex; flex-direction: column; width: 350px;
    }

    .form-container h2 { margin-bottom: 20px; font-size: 24px; text-align: center; }
    
    .form-container input {
      width: 100%; padding: 10px; margin: 10px 0;
      border: none; border-radius: 5px; font-size: 16px;
    }

    .form-container button {
      background-color: #ff9800; color: white; padding: 10px; border: none;
      cursor: pointer; width: 100%; margin-top: 10px; border-radius: 5px;
      font-size: 16px; font-weight: bold;
    }

    .form-container button:hover { background-color: #e68900; }

    .toggle-btn {
      background: transparent; border: none; font-size: 16px; color: white; 
      cursor: pointer; text-decoration: underline; margin-bottom: 10px;
    }

    /* 游댠 Estilo para el modal */
    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 2000;
      justify-content: center;
      align-items: center;
    }

    /* 游댠 Contenido del modal */
    .modal-content {
      background: white;
      color: black;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      width: 300px;
      box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.3);
    }

    /* 游댠 Bot칩n de cerrar */
    .modal-buttons {
      display: flex;
      justify-content: center;
      margin-top: 15px;
    }

    .modal-buttons button {
      padding: 10px 15px;
      border: none;
      cursor: pointer;
      font-size: 16px;
      transition: 0.3s;
    }

    #btnCerrarModal {
      background-color: #ff9800;
      color: white;
      border-radius: 5px;
    }

    #btnCerrarModal:hover {
      background-color: #e68900;
    }
  </style>
</head>
<body>
  <div class="overlay"></div>
  <div class="container">
    <div class="welcome-text">
      <h1>Komikoo's VDB</h1>
      <p>Komikoo's Vitals Data Base es una base de datos que se encuentra en Firebase
        hospedada en GitHub como proyecto universitario de la Universidad Tecnol칩gica
        de Nogales. El artefacto mide los vitales mediante un malet칤n con todos los
        sensores necesarios envi치ndolos a una aplicaci칩n en QT, la cual publica los
        datos en la base de datos. Esta p치gina gestiona las claves de acceso y
        permite visualizar los datos seg칰n el rol del usuario.</p>
    </div>

    <div class="form-container" id="authForms">
      <h2 id="formTitle">Ingresar</h2>
      <input type="email" id="email" placeholder="Email Address">
      <input type="password" id="password" placeholder="Password">
      <button id="authButton" onclick="authAction()">Ingresar a cuenta</button>
      <button class="toggle-btn" onclick="toggleAuth()">Crear cuenta</button>
    </div>
  </div>

  <!-- 游댠 Modal para mensajes -->
  <div id="modalMensaje" class="modal">
    <div class="modal-content">
      <p id="modalTexto">Mensaje aqu칤</p>
      <div class="modal-buttons">
        <button id="btnCerrarModal">Aceptar</button>
      </div>
    </div>
  </div>

  <script>
    async function cargarConfigFirebase() {
      try {
        const response = await fetch("https://raw.githubusercontent.com/Komikoo-Koo/FireKokosVDB/Scripts/firebase-config.js");
        const script = await response.text();
        eval(script);

        if (typeof firebaseConfig !== "undefined") {
          firebase.initializeApp(firebaseConfig);
          window.auth = firebase.auth();
          window.db = firebase.database();
        } else {
          mostrarModal("游댠 Error: No se pudo cargar la configuraci칩n de Firebase.");
        }
      } catch (error) {
        mostrarModal("游댠 Error al cargar Firebase Config: " + error.message);
      }
    }
    cargarConfigFirebase();

    let isSignIn = true;
    function toggleAuth() {
      const title = document.getElementById("formTitle");
      const authButton = document.getElementById("authButton");
      const toggleBtn = document.querySelector(".toggle-btn");

      isSignIn = !isSignIn;

      if (isSignIn) {
        title.textContent = "Ingresar";
        authButton.textContent = "Ingresar a cuenta";
        toggleBtn.textContent = "Crear cuenta";
      } else {
        title.textContent = "Registro";
        authButton.textContent = "Crear cuenta";
        toggleBtn.textContent = "쯏a tienes cuenta?";
      }
    }

    async function authAction() {
      let email = document.getElementById("email").value.trim();
      let password = document.getElementById("password").value.trim();

      if (email === "" || password === "") {
        mostrarModal("Por favor, llena todos los campos.");
        return;
      }

      try {
        if (isSignIn) {
          const userCredential = await window.auth.signInWithEmailAndPassword(email, password);
          mostrarModal("Inicio de sesi칩n exitoso.");
          setTimeout(() => window.location.href = "New.html", 1500);
        } else {
          const userCredential = await window.auth.createUserWithEmailAndPassword(email, password);
          mostrarModal("Registro exitoso. Redirigiendo...");
          setTimeout(() => window.location.href = "New.html", 1500);
        }
      } catch (error) {
        mostrarModal("Error: " + error.message);
      }
    }

    function mostrarModal(mensaje) {
      document.getElementById("modalTexto").textContent = mensaje;
      document.getElementById("modalMensaje").style.display = "flex";
    }

    document.getElementById("btnCerrarModal").addEventListener("click", function() {
      document.getElementById("modalMensaje").style.display = "none";
    });
  </script>
</body>
</html>
